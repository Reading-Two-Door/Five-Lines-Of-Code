# 최적화 및 일반화 회피

- 코드 처리량을 늘리거나 처리 시간을 줄이는 성능 최적화
- 코드가 더 일반적인 매개변수를 통해 더 많은 기능을 포함하도록 하는 것

## 12.1 단순성 추구

- 더 일반적인 것을 만들면 그로 인해 용도가 증가하고 따라서 더 많은 것이 결합될 수 있다.
- 반복해서 실행하는 것은 낭비이므로 총 요소를 추적하는 total 필드를 도입해서 낭비를 줄일 수 있다.
- 단순함을 희생할 때는 부작용을 최소화하기 위해 예방 조치를 취해야 한다.

## 12.2 일반화의 시기와 방법

- 메서드나 클래스에 일반화를 추가하기 전에 이유가 존재해야 한다.

### 12.2.1 구현의 최소화로 일반화 지양하기

- 최소로 구축
- 요구된 대로만 구축하는 또 다른 이유는 요구사항이 변경됨에 따라 불필요한 일반화를 구현하고 유지하는 데 드는 모든 노력이 쉽게 무효화되기 때문이다.

### 12.2.2 안전성이 유사한 것 통합하기

- 새로운 것과 오래된 것을 바로 통합하지 않는 것이 가장 좋다.
- 통합 대상이 비슷한 안정성에 도달할 떄까지 기다려라.

### 12.2.3 불필요한 일반화 제거

- 정기적으로 모니터링해서 발견 시 제거하는 것
- 함수에 전달된 런타임 인자들을 모니터링

## 12.3 최적화 시기와 방법

- 최적화 역시 필요성이 납득 되어야 한다.
- 성능 테스트를 설정하고 테스트가 실패할 때만 최적화하는 것이 좋다.
  - 벤치마크 테스트
  - 부하 테스트
  - 성능 승인 테스트

### 12.3.1 최적화 전 리팩터링

- 코드가 적절하게 리팩터링 되었는지 확인

**컴파일러에게 맡기기**

- 컴파일러를 거스르지마라
- 과시적인 표현을 사용하지마라

### 12.3.2 제약 이론에 따른 최적화

- 리팩터링한 후 테스트가 만족스럽지 않으면 최적화해야한다.
- 병목을 최적화하면 새로운 병목 현상에 맞닥뜨릴 수 있다.

### 12.3.3 측정 지표를 사용한 최적화

### 12.3.4 좋은 알고리즘과 데이터 구조 선택하기

- 가장 안전한 최적화는 동등한 인터페이스를 가진 다른 데이터 구조로 바꾸는 것이다.

### 12.3.5 캐시 사용하기

- 계산을 여러 번 수행하는 대신 수행한 결과를 저장하여 재사용
- 멱등 불변속성과 조합될 때 가장 안전하다.
- 멱등성이 일시적인 경우 만료 시간 내에 깨질 수 있기 때문에 취약하다.

### 12.3.6 최적화된 코드 분리하기
