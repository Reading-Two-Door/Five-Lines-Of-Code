# :zap:01. 리팩터링 리팩터링 하기

## 개요
- 리팩토링은 높은 품질의 코드를 얻는 가장 일반적인 방법
- 리팩토링은 스킬, 문화, 도구 3박자가 맞아 떨어져야 함
- 스킬
  - 숙련된 프로그래머는 코드 스멜에 대한 지식을 가지고 이를 알아낼 수 있음
    - 코드 스멜은 판단과 경험이 필요하기에 배우기 쉽지 않음. 주니어 개발자들은 코드 스멜을 스킬이라기보단 육감 같은 것으로 이해함
- 문화
  -  리팩토링에 시간을 들이는것을 권장하는 문화과 절차가 필요.
  -  대개 TDD에서 사용되는 레드-그린-리팩터 순환절차 구현
- 도구
  - 리팩토링 작업이 안전하다는 것을 보장할 무언가가 필요.
  - 일반적인 방법은 자동화된 테스트.

## 1.1 리팩터링이란 무엇인가
- 다음과 같은 과정을 리팩토링의 근본이라 할 수 있음
- ```javascript
  // 변경 전
  return pow(base, exp/2) * pow(base, exp/2);

  // 변경 후
  let result = pow(base, exp/2);
  return result * result
- 리팩터링을 해야하는 근본적인 이유
  - 코드를 더 빠르게 만들기 위해
  - 더 작은 코드를 만들기 위해
  - 코드를 더 일반적이거나 재사용 가능하게 하기 위해
  - **코드를 읽기쉽게 가족성을 높이고 유지보수를 용이하게 하기 위해** <- 핵심
- 리팩토링은 코드를 변경해서는 안됌. 가독성과 유지보수성에 중점을 두어야 함.
  - 즉 기능을 변경하지 않고 코드의 가독성과 유지보수가 쉽도록 코드 변경.
- 코드베이스는 생각하기 편함. 코드가 하는 일에 대해 머릿속으로 해석하는데 한번에 많은것을 기억해야 할수록 힘듦.
  - 이것이 처음부터 만드는것이 편하고 디버깅이 끔찍한 이유

## 1.2 스킬 : 무엇을 리팩터링 할것인가
- 코드 스멜은 코드가 나쁘다는 것을 암시. 그러나 추상적이고 시작하기 어려워 감각 키우는데 시간이 오래걸림
- 이 책에서는 색다른 쉽고 빠른 접근방식 제안. 예를들어 이 책의 주제이기도 한 '다섯 줄 제안'. **단 너무 엄격해서 스멜이 없는 코드를 수정해야할 수 있음. 떄때로 규칙을 따르고도 여전히 스멜을 풍기는 코드가 될 수 있음.**
- 잘 알려진 코드 스멜 : 함수는 한 가지 작업을 수행해야 한다
- 이 책의 제안 방식은 자전거의 보조바퀴와 비슷한 역할. 모든상황에서 좋은 코드 보장x. 단 어디서 시작해야할 지 모르는 경우 유용하고 멋진 코드 리팩터링의 이유를 제공 가능.
- 규칙의 모든 이름은 절대용어(용어만으로도 비교와 같은 상대적 해석 필요 없이 자체적으로 명확한 용어) 사용해서 기억하기 쉬움

## 1.3 문화 : 리팩터링은 언제?
- 정기적으로 수행하는게 효과적이고 비용이 적게 듦. 가능하면 일상 업무에 통합하는 것이 좋음.
- 6단계 프로그래밍 작업 절차 권장
  1. 탐색 : 무엇을 할지 확신이 안설수 있음. 항상 실험부터 시작. 신속하게 구현하면 고객이 뭘 필요로하는지 파악 가능
  2. 명세화 : 무엇을 만들지 알게되면 명세화
  3. 구현
  4. 테스트
  5. 리팩터링 : 코드 전달 전 다음 사람이 쉽게 작업 가능한지 확인
    ![image](https://github.com/user-attachments/assets/a9647a7f-36bf-43e6-a4ca-6abe01f354d1)
  6. 전달 : 가장 일반적인것은 PR (Pull Request)
- 레거시 시스템에서 리팩터링
  - 유명한 명언 : **우선 변경하기 쉽게 만든 후 변경하라 - 켄트 백**
  - 새로운것을 구현할 때마다 새 코드를 쉽게 추가할 수 있게 리팩터링 먼저 진행.
- 리팩터링이 필요하지 않은 세 가지 경우
  1. 1회성 코드
  2. 폐기되기 전 유지보수 모드에 있는 코드
  3. 엄격한 성능 요구사항이 있는 코드
  4. 그외 모든 경우에는 리팩터링에 투자하는것이 좋음

## 1.4 도구 : 안전한 리팩터링 방법
- 자동화된 테스트는 like 자동차의 브레이크. 느리게 갈 때는 존재감 없지만 빨리 달릴때는 브레이크로 인해 안정감을 느낌.
- 다음과 같은 도구에 의존하는것 추천
  - 리팩터링 패턴
  - 버전 관리
  - 컴파일러
- 문제가 없으면 커밋하면서 중간중간 세이브포인트 만들기

## 1.5 시작하는데 필요한 도구
- 객체지향 언어가 필요, 타입스크립트 적합.

## 1.6 핵심예제 : 2D 퍼즐게임
- DRY : Don't Repeat Yourself
- KISS : Keep It Simple, Stupid

## 1.7 실제 환경에서 소프트웨어에 대한 주의사항
- 규칙을 사용하는 방법은 먼저 그 이름을 익히고 따라 하는 것.
  - 여기에 익숙해지면 예외를 포함한 설명을 학습.
   ![image](https://github.com/user-attachments/assets/15bef8fa-bac4-4a75-aea7-d00e4b8b9eef)
  - 구체적인 규칙 지키기
    - 매우 구체적인 이름
    - 예외 형태로 뉘앙스를 더하는 설명
    - 그것들이 나오게 된 스멜의 의도
- 1부에서는 앞서 제공된 2D 퍼즐게임의 소스코드 바꿈.
